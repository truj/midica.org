---
layout: index
meta-title: "MidicaPL Tutorial 2: Improving - Music Programming Language for Midica"
meta-desc:  "Use channel commands and complex note lengths. Use soundbanks and percussion instruments. Produce Karaoke songs."
---

<div class="grid-container midicapl">
	<div class="grid-x grid-padding-x">
		<h1 class="cell">MidicaPL Tutorial, Chapter 2: Improving</h1>
	</div>
	<section class="grid-x grid-padding-x" id="intro">
		<div class="cell">
			<p>
				This is the second chapter of the MidicaPL tutorial. Please read <a href="tutorial-1.html">chapter 1</a> first,
				if you have not yet done that already.
			</p>
			<p>
				In this chapter you will learn about lowlevel commands, all the details about channel options and how to create karaoke songs.
				Moreover you will learn everything about complex note lengths, how to use percussion instruments, and how to use
				soundbanks.
			</p>
		</div>
	</section>
	<section class="grid-x grid-padding-x" id="lowlevel-channel-commands">
		<div class="cell">
			<h2>Lowlevel Channel Commands</h2>
		</div>
		<div class="cell">
			<p class="hint">
				In newer Midica versions, lowlevel commands are not needed any more.
				If you are not interested how to use them, you can <a href="#channel-options">skip this section</a>.
			</p>
			<p>
				The channel commands from the last chapter are <em>compact</em> channel commands.
				Compact means, you can play several notes, chords or rests in a single line.
				There is also another kind of command called <em>lowlevel</em> channel command, allowing only one note or chord or rest per line.
			</p>
			<p>
				In earlier Midica versions there were some things you could not express with <em>compact</em> commands.
				But since version 1.5.4 the <em>compact</em> commands support everything that <em>lowlevel</em> commands support.
			</p>
			<p>
				Still it is useful to know that <em>lowlevel</em> commands exist, and how they look - at least for one reason:
				If you forget the <code>:</code> after the channel number of a compact command, Midica may think that you tried to use an illegal
				<em>lowlevel</em> command. And then the resulting error message could be confusing.
			</p>
			<p>
				A <em>lowlevel channel command</em> consists of at least 3 columns, separated by whitespaces:
			</p>
			<ol>
				<li>Channel column</li>
				<li>Note column</li>
				<li>Length column</li>
				<li>
					(Optional) After the 3rd column one or more options may follow. Details will be described later in this chapter.
				</li>
			</ol>
			<p>
				The following example shows "Happy birthday to you" on channel <em>0</em> again, but this time written with lowlevel commands.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.happy-birthday-lowlevel }}</div>
		<div class="cell large-4">
			<h3>Channel column</h3>
			<p>
				This column contains the chanel number but (unlike compact commands) without a trailing <code>:</code>.
				Valid values are the numbers <code>0</code> - <code>15</code> and the symbol <code>p</code>.
				Again, <code>p</code> is an alias for <code>9</code> (percussion channel).
			</p>
		</div>
		<div class="cell large-4">
			<h3>Note column</h3>
			<p>
				This column can contain a <em>note name</em>, a <em>percussion ID</em>, a <em>chord</em> (inline or predefined)
				or a rest (<code>-</code>). Alternatively you can also use the <em>MIDI note number(s)</em>.
			</p>
		</div>
		<div class="cell large-4">
			<h3>Length column</h3>
			<p>
				This column contians a length definition. E.g. a <em>full</em>, a <em>half</em>, a <em>quarter</em> or <em>eighth</em> note and so on
				can be defined like <code>1</code>, <code>2</code>, <code>4</code>, <code>8</code> and so on.
				More details about length definitions will follow later in this chapter.
			</p>
		</div>
		<div class="cell">
			<h3>Mixing Compact and lowlevel commands</h3>
			<p>
				Both channel command types can be mixed, like the following example demonstrates:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.happy-birthday-mixed }}</div>
		<div class="cell">
			<p>
				The note length definition of a <em>lowlevel</em> command does NOT change the default note length of a <em>compact</em> command!
			</p>
			<p>
				So in the last line the default is still a 16th note, and we have to switch to a 4th explicitly. Even if there have been other
				4th notes in the lowlevel commands in line 2 and 3.
			</p>
		</div>
	</section>
	<section class="grid-x grid-padding-x" id="channel-options">
		<div class="cell">
			<h2>Channel Options</h2>
		</div>
		<div class="cell medium-6">
			<p>
				Channel commands can have options. This applies for <em>compact</em> commands as well as for <em>lowlevel</em> commands.
				However the syntax is different, and also the available options.
			</p>
			<p>
				In a <em>compact</em> command an option is embedded between parenthesis <code>(</code> and <code>)</code>.
			</p>
			<p>
				In a <em>lowlevel</em> command, they are written into the 4th column. Everything after the length column is regarded as options.
			</p>
			<p>
				Each option has a name, and most options also have a value. Name and value are separated with <code>=</code>.
				If a channel command has more than one option, the options are separated by <code>,</code>.
			</p>
			<p>
				Most options have a long name and an abbreviation, which can be used instead of the long name. But enough theory,
				the <span class="reference">Channel Options</span> table shows the options:
			</p>
		</div>
		<div class="cell medium-6">
			<table>
				<caption>
					Channel Options
				</caption>
				<thead>
					<tr>
						<th>Long Name</th>
						<th>Short Name</th>
						<th>Value Type</th>
						<th>Value Range</th>
						<th>Cmd type</th>
						<th>Impact</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td>velocity</td>
						<td>v</td>
						<td>integer</td>
						<td>1 - 127</td>
						<td>both</td>
						<td>permanent</td>
					</tr>
					<tr>
						<td>duration</td>
						<td>d</td>
						<td>float or %</td>
						<td>>0.0 - &infin; (>0% - &infin;%)</td>
						<td>both</td>
						<td>permanent</td>
					</tr>
					<tr>
						<td>quantity</td>
						<td>q</td>
						<td>integer</td>
						<td>1 - &infin;</td>
						<td>both</td>
						<td>once</td>
					</tr>
					<tr>
						<td>multiple</td>
						<td>m</td>
						<td>-</td>
						<td>-</td>
						<td>both</td>
						<td>once</td>
					</tr>
					<tr>
						<td>lyrics</td>
						<td>l</td>
						<td>text</td>
						<td>-</td>
						<td>both</td>
						<td>once</td>
					</tr>
					<tr>
						<td>tremolo</td>
						<td>tr</td>
						<td>length</td>
						<td>-</td>
						<td>both</td>
						<td>once</td>
					</tr>
					<tr>
						<td>shift</td>
						<td>s</td>
						<td>integer</td>
						<td>-127 - 127</td>
						<td>lowlevel</td>
						<td>once</td>
					</tr>
					<tr>
						<td>length</td>
						<td>-</td>
						<td>length</td>
						<td>-</td>
						<td>compact</td>
						<td>permanent</td>
					</tr>
				</tbody>
			</table>
		</div>
		<div class="cell">
			<h3>Velocity</h3>
		</div>
		<div class="cell">
			<p>
				The velocity is the force with which a note is played. The more velocity, the louder the note. The option name is <code>velocity</code>.
				The short form is <code>v</code>.
			</p>
			<p>
				The value can be between 1 and 127. The default is 100. If the velocity option is used in a channel command, the following commands in the same
				channel will also use this velocity value. Until the option is used in the same channel again, with a different value.
			</p>
			<p>
				The following example shows how to use velocity, first with <em>compact</em> and then with <em>lowlevel</em> commands.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.velocity }}</div>
		<div class="cell">
			<p>
				The example shows different ways to use the long or short form of the option.
			</p>
			<p>
				It also shows that whitespaces and the <code>=</code> is optional in lowlevel commands. But compact commands are stricter.
				Here you cannot use any whitespaces between the parenthesis, and the <code>=</code> is mandatory.
			</p>
		</div>
		<div class="cell">
			<h3>Duration</h3>
		</div>
		<div class="cell">
			<p>
				The duration option describes after which percentage of the note length, the pressed key is released.
				The option name is <code>duration</code>. The short form is <code>d</code>.
				The values can be either floating point numbers or percentage values ending with <code>%</code>.
				Low values result in "staccato", high values result in "legato".
			</p>
			<p>
				If two notes are played after each other, and the duration value is 1.0 (or 100%) then the first note is released in the same
				moment when the second one is pressed. A value of 0.9 (or 90%) means that the first note is released after 90% of its
				official length. So the note is 10% shorter than its theoretical length.
			</p>
			<p>
				The default value is 0.95 (or 95%), meaning that the key is released 5% before its theoretical end.
				Values higher than 1.0 are also allowed. Then the notes overlap: The former note is released after the following one begins.
			</p>
			<p>
				If the duration option is used in a channel command, the following commands in the same channel will use the same duration value.
			</p>
			<p>
				The following example shows a compact and a lowlevel version of the same sequence with duration changes:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.duration-ratio }}</div>
		<div class="cell">
			<p>
				The last two notes have a change of duration as well as a change of velocity. Two options can be changed together.
				But in the compact version no whitespaces are allowed.
			</p>
		</div>
		<div class="cell">
			<h3>Quantity</h3>
		</div>
		<div class="cell">
			<p>
				The quantity option repeats a command any number of times. The option name is <code>quantity</code>.
				The short form is <code>q</code>.
			</p>
			<p>
				In <em>compact</em> syntax, the command affects the <em>next</em> compact note or chord or rest after the option in the same channel.
			</p>
			<p>
				The following example shows the beginning of "The Four Seasons: Summer", 3rd movement, by "Antonio Vivaldi".
				It uses a violin in channel 0 and a harpsichord in channel 6. (Please update your <code>INSTRUMENTS</code> block accordingly.)
				The first example is a <em>compact</em> version, the second one is a <em>lowlevel</em> version of the sequence.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.quantity }}</div>
		<div class="cell">
			<p>
				Here is another example of the same sequence in <em>compact</em> syntax:
			</p>
		</div>
		<div class="cell medium-shrink">{{> src-example src-examples.quantity-2 }}</div>
		<div class="cell medium-auto">
			<p>
				The <code>(q=11)</code> in the first line is not yet consumed by any note in the same line.
				In the second line it's not consumed as well because this is for another channel.
				In the third line, this option is still open, so it's consumed by the note <code>g-</code>.
			</p>
		</div>
		<div class="cell">
			<h3>Multiple</h3>
		</div>
		<div class="cell">
			<p>
				The multiple option is used to play different voices in the same channel.
				It allows to play different notes with different lengths and/or different velocity or duration options in
				the same time and channel.
			</p>
			<p>
				The option name is <code>multiple</code>. The short form is <code>m</code>. It does not have any value.
			</p>
			<p>
				In <em>compact</em> syntax, the command affects the <em>next</em> compact note or chord or rest after the option in the same channel.
			</p>
			<p>
				As we already know, each note (or chord or rest) is added to the end of a channel. To be more precise,
				it's added to a <em>marker</em> that is <em>usually</em> at the end of the channel.
				After adding the note, this marker is moved from the old end of the channel to the new end of the channel.
			</p>
			<p>
				But if we use the multiple option, the marker is not moved.
				So the next note that is added to the channel, begins at the same time as the note with the multiple option.
			</p>
			<p>
				The following example demonstrates this, first with compact and then with lowlevel syntax, producing the same sequence:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.multiple }}</div>
		<div class="cell">
			<p>
				This example shows some possibilities to use the multiple option. The first bar uses 2 voices, shown as blue and black.
				The full note (<code>c</code>) and the first quarter note (<code>g</code>) begin in the same time because of the multiple option.
			</p>
			<p>
				In the second example we have 2 voices again (blue and black). But they don't begin in the same time, so we need to add
				a rest in the black voice. The blue voice sounds longer than the black one, so we need another rest at the end of the
				second bar.
			</p>
			<p>
				In the third bar we have three voices: blue, green and black. They all begin at different times but end in the same time.
			</p>
		</div>
		<div class="cell">
			<h3>Lyrics</h3>
			<div class="cell">
				<p>
					The lyrics option can be used to add a syllable. This way you can make your song ready for karaoke.
					The option name is <code>lyrics</code>. The short form is <code>l</code>.
				</p>
				<p>
					If you need whitespaces or commas inside of the syllabe, you must use the following symbols:
				</p>
				<ul>
					<li><code>_</code> for a space</li>
					<li><code>\r</code> for a new line</li>
					<li><code>\n</code> for a new paragraph</li>
					<li><code>\c</code> for a comma <code>,</code></li>
				</ul>
				<p>
					The following example shows how to create a karaoke version of "Happy Birthday" - first with <em>lowlevel</em> commands,
					and then the same sequence with <em>compact</em> commands.
				</p>
			</div>
		</div>
		<div class="cell">{{> src-example src-examples.lyrics }}</div>
		<div class="cell">
			<p>The last screenshot shows how the result looks inside of the player in karaoke mode.</p>
		</div>
		<div class="cell">
			<h3>Tremolo</h3>
			<div class="cell">
				<p>
					The tremolo option is an alternative notation for note (or chord) repetitions.
					The option name is <code>tremolo</code>. The short form is <code>tr</code>.
				</p>
				<p>
					In <em>compact</em> syntax, the command affects the <em>next</em> compact note or chord after the option in the same channel.
				</p>
				<p>
					The note length of a tremolo'ed note defines the overall length over all repetitions.
					The length of each repeated note is provided as the option value.
				</p>
				<p>
					The next three examples are equivalent. The first two use the tremolo option (compact first, lowlevel second),
					while the third one uses the quantity option.
				</p>
			</div>
			<div class="cell">{{> src-example src-examples.tremolo }}</div>
			<div class="cell">
				<p>
					As you can see in the last line, the tremolo option can also be used to express drum rolls.
				</p>
				<p>
					(A detailed explanation about <a href="#percussion">percussion</a> will follow later in this chapter.)
				</p>
			</div>
		</div>
		<div class="cell">
			<h3>Shift</h3>
			<div class="cell">
				<p class="hint">
					This section describes a lowlevel form of transposing. Probably you will never need it.
					You can find a more usable form for transpositions in the chapters 3 and 4.
				</p>
				<p>
					The shift option is only available for lowlevel commands. It transposes the given note or chord an
					arbitrary number of half tone steps into one direction.
					The option name is <code>shift</code>. The short form is <code>s</code>.
				</p>
				<p>
					The value is the number of half tone steps for the transposition. It can be negative for a lower transposition
					or positive for a higher transposition.
				</p>
				<p>
					The next two examples are equivalent. The first one uses the shift option, while the second one just uses normal notes.
				</p>
			</div>
			<div class="cell">{{> src-example src-examples.shift }}</div>
		</div>
		<div class="cell">
			<h3>Length</h3>
			<div class="cell">
				<p>
					The length option is only available for compact commands. It can be used to switch the current note length without playing a note or rest.
				</p>
				<p>
					The following two examples of "Happy Birthday" are equivalent. The first one uses the length option while the second one
					switches note lengths the normal way.
				</p>
				<div class="cell">{{> src-example src-examples.length }}</div>
			</div>
		</div>
	</section>
	<section class="grid-x grid-padding-x" id="length-definitions">
		<div class="cell">
			<h2>Length Definitions</h2>
		</div>
		<div class="cell">
			<p>
				So far we learned <em>where</em> we can define note lengths:
			</p>
			<ul>
				<li>In <em>compact</em> commands: after the note name, separated by a colon (<code>:</code>)</li>
				<li>In a <em>lowlevel</em> command: in the 3rd column</li>
				<li>In <em>compact</em> commands: as the value of a <code>length</code> option</li>
				<li>In any command: as the value of a <code>tremolo</code> option</li>
			</ul>
			<p>
				And we know how to define the most frequently used note lengths. Now let's see how to compose all possibilities of lengths.
			</p>
			<p>
				The easiest length is an <em>atomic</em> length. It can be modified by one or more modifiers to create a <em>modified length</em>.
				And last but not least you can combine two or more atomic or modified lengths to form a <em>sum of lengths</em>.
			</p>
			<h3>Atomic Lengths</h3>
			<p>
				You can just use an integer number as a note length. The resulting length corresponds
				to a full note's length divided by that number. This is one kind of atomic length.
			</p>
			<p>
				Apart from this, there are also the following <em>predefined</em> atomic lengths:
			</p>
			<p>
				<code>/1</code> (full),
				<code>/2</code> (half),
				<code>/4</code> (quarter),
				<code>/8</code> (eighth),
				<code>/16</code> (sixteenth),
				<code>/32</code> (thirty-second)
			</p>
			<p>
				<code>*1</code> (full),
				<code>*2</code> (double),
				<code>*4</code> (four wholes),
				<code>*8</code> (eight wholes),
				<code>*16</code> (sixteen wholes),
				<code>*32</code> (thirty-two wholes)
			</p>
			<p>
				This makes atomic note lengths available that are longer than a full note - those beginning with <code>*</code>.
			</p>
			<p>
				The shorter notes (beginning with <code>/</code>) are not really needed as they can be replaced by just the number
				without the prefixed <code>/</code>. However they can make lowlevel commands a bit more readable.
				But in compact commands they look quite cumbersome, so you probably don't want to use them there.
			</p>
			<p>
				From now on we will use predefined notes in lowlevel commands and (if possible) just numbers in compact commands.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.atomic }}</div>
		<div class="cell">
			<p>
				The first example uses compact commands and only numbers, if possible. In channel 0 only a predefined length is possible.
			</p>
			<p>
				The second example uses lowlevel commands and only predefined lengths, if possible. For the last two notes only numbers are possible
				because a 64th note is so rare that it has no predefined version.
			</p>
		</div>
		<div class="cell">
			<h3>Modified Lengths</h3>
			<h4>Dot Modifiers</h4>
			<p>
				An atomic length can be modified. You already know the modifier <code>.</code>. It makes the atomic length one half longer, so that it's 3/2
				of the atomic length.
				You can add as many dots as you want. Two dots (<code>..</code>) make it longer by three quarters, resulting in 7/4 of it's atomic length.
				Three dots result in 15/8 of the atomic length. And so on.
			</p>
			<p>
					Here is a compact and a lowlevel example showing how dots can be used:
				</p>
			</div>
		<div class="cell">{{> src-example src-examples.dot }}</div>
		<div class="cell">
			<p>
				Channel 1 is only added for comparison reasons.
			</p>
		</div>
		<div class="cell" id="triplet">
			<h4>Triplet Modifiers</h4>
			<p class="hint">
				This section describes a lowlevel form of defining triplets. An easier to write (highlevel) form will follow in chapter 4.
			</p>
			<p>
				A triplet modifier shortens the atomic length by one third, resulting in 2/3 of the atomic length.
				The triplet modifier is a <code>t</code>.
				Just like a dot, a triplet can be applied as often as you want, resulting in nested triplets.
				Two triplet modifiers result in a length of 4/9 (2/3 * 2/3). Three such symbols result in 8/27 (2/3 * 2/3 * 2/3). And so on.
			</p>
			<p>
				Here is a compact and a lowlevel example showing how triplets can be used:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.triplet }}</div>
		<div class="cell">
			<p>
				Channel 1 is added for comparison reasons again.
				The first triplet consists of 3 shortened eighths taking the time of a quarter.
				The second triplet is only slightly more complicated. It also contains a dotted eighth and a sixteenth.
			</p>
			<p>
				The third triplet contains a dotted note again. But this time the dot is placed before the <code>t</code> symbol.
				This demonstrates that the order
				of modifiers does not matter. The triplet also contains a rest that needs to have a modified length as well.
			</p>
			<p>
				The fourth triplet contains a nested triplet, marked in blue. So the notes of the inner triplet need to be modified by two
				<code>t</code> symbols.
			</p>
			<p>
				The last triplet consists of three half notes having the length of one full note. It also contains a chord.
			</p>
		</div>
		<div class="cell" id="tuplet">
			<h4>Tuplet Modifiers</h4>
			<p class="hint">
				This section describes a lowlevel form of defining tuplets. An easier to write (highlevel) form will follow in chapter 4.
			</p>
			<p>
				A triplet is only one special type of tuplet. Generally a tuplet is used to change the length of a sequence of notes in a way that
				has to be defined in the tuplet definition. A Tuplet modifier is defined by the symbol <code>t</code>, followed by two numbers that
				are separated by <code>:</code>. So a triplet could also be defined as <code>t3:2</code> meaning something like "3 for 2" or "3 notes
				have the length of 2".
			</p>
			<p>
				Mathematically you can say: tX:Y means that the length is multiplied with Y/X. So a note inside of a quadruplet would be modified with
				<code>t4:3</code>. And something inside a quintuplet with <code>t5:4</code>.
			</p>
			<p>
				Here is a compact and a lowlevel example showing how tuplets can be used:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.tuplet }}</div>
		<div class="cell">
			<p>
				Again, channel 1 is only added for comparison reasons.
				The first tuplet is a 5:2 tuplet that could contain 5 notes (or rests) with the length of 2. So the length of each note or rest
				is modified by 2/5.
			</p>
			<p>
				The second tuplet is a 3:4 tuplet modifying all lengths by 4/3. So you see that a tuplet can also be defined to make notes longer
				instead of shorter. This tuplet contains a nested triplet (marked in blue) that has been explicitly defined as <code>t3:2</code>
				instead of <code>t</code>. Because of the nesting, both tuplet modifiers have to be attached to each other.
			</p>
			<p>
				The last tuplet contains different note lengths and a chord.
			</p>
		</div>
		<div class="cell">
			<h3>Sums of Lengths</h3>
			<p>
				Sometimes a note length cannot be described easily with an atomic or modified length. But it can easily be described as a sum of two lengths.
				In sheet music such notes are typically printed as 2 notes with a <em>tie</em> between them.
				In MidicaPL such a note length can be described as two atomic or modified lenghts, separated by a <code>+</code> symbol.
			</p>
			<p>
				The following example shows the first few notes of "Hey Jude" by the "Beatles" with <em>compact</em> commands.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.hey-jude }}</div>
		<div class="cell">
			<p>
				A half and an eighth note are tied together. This is described as <code>2+8</code>.
			</p>
			<p>
				More complicated expressions are also possible like <code>/2.+/1+/2t</code>. Here is a lowlevel example:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.length-plus }}</div>
		<div class="cell">
			<h3>Zero-Length</h3>
			<p>
				There is one special length symbol: <code>-</code>. It means "no length at all".
				Of cause this does not make sense for any normal note, chord or rest. However it can be is useful to change
				a channel option in a lowlevel command without playing a note or chord.
			</p>
			<p>
				In compact commands it does not make any sense at all, however.
			</p>
			<p>
				The zero-length is only allowed in combination with a rest but not with a note or chord.
				So the second and third column both have the symbol <code>-</code>.
			</p>
			<p>
				The following examples are equivalent:
			</p>
			<div class="cell">{{> src-example src-examples.zero-length }}</div>
			<p>
				The first example uses zero-length rests to change the velocity and duration of the following notes.
			</p>
			<p>
				The second example uses real rests, but with <code>m</code> as additional option. This is an alternative for zero-length rests.
			</p>
			<p>
				The third example doesn't use rests at all but applies the channel parameters directly to a note.
			</p>
		</div>
	</section>
	<section class="grid-x grid-padding-x" id="percussion">
		<div class="cell">
			<h2>Percussion Instruments</h2>
		</div>
		<div class="cell">
			<p>
				In order to produce sounds, we learned how to configure a certain instrument for a channel. Then we used notes to play
				different pitches in that channel. With Percussion instruments this is different.
				A percussion instrument has only one pitch. It's somthing like a drum, a hand clap, a cow bell or a triangle.
				Using notes for such instruments is not very useful.
			</p>
			<p>
				Percussion instruments are usually played in channel 9, the special percussion channel. In the <code>INSTRUMENTS</code> block
				this channel cannot be associated with an instrument but with a drumkit.
			</p>
			<p>
				When playing something later in this channel, this is not a note but a certain percussion instrument.
				Instead of the note name you write a percussion ID. Each percussion instrument has a long ID and a short ID.
				The valid IDs can be seen in the <em>info window</em> under <a href="/screenshots.html#info-config">Configuration / Percussion IDs</a>.
			</p>
			<p>
				The next two examples are equivalent. They play the intro for "We Will Rock You" by "Queen".
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.we-will-rock-you }}</div>
		<div class="cell">
			<p>
				The first example uses <em>lowlevel</em> commands and long percussion IDs. The second one uses <em>compact</em> commands and short IDs.
			</p>
			<p>
				Like a chord of notes, you can also play two percussion sounds in the same time. Just separate the IDs with a <code>,</code>.
				The following example shows the beginning of "Billie Jean" by "Michael Jackson".
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.billie-jean }}</div>
		<div class="cell">
			<p>
				The short percussion IDs from this example are equivalent to the following long IDs:
			</p>
			<ul>
				<li><code>hhc</code> equals <code>hi_hat_closed</code></li>
				<li><code>sd1</code> equals <code>snare_drum_1</code></li>
				<li><code>bd1</code> equals <code>bass_drum_1</code></li>
			</ul>
			<p>
				The first result score is easier to read for non-drummers. The second one is more compact and more what a drummer is used to read.
			</p>
		</div>
	</section>
	<section class="grid-x grid-padding-x" id="soundbanks">
		<div class="cell">
			<h2>Using Soundbanks</h2>
		</div>
		<div class="cell">
			<h3>Include Soundbank File</h3>
		</div>
		<div class="cell">
			<p>
				In the preparation section you learned how to <a href="/tutorial.html#sound">load a Soundbank</a> manually in the main window of
				the Midica application.
			</p>
			<p>
				But there are a lot of different soundbanks out there, specialized for different kinds of music. So maybe you want to use different
				soundbanks for different songs. And maybe you don't want to choose the soundbank file manually each time you switch to another
				MidicaPL file containing another song.
			</p>
			<p>
				In this case you can use the <code>SOUNDBANK</code> command. Its only argument is the path or URL to a soundbank file in the
				<code>.sf2</code> or <code>.dls</code> format. The path can be either absolute or relative to the source file containing the command.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.soundbank-path }}</div>
		<div class="cell">
			<p>
				Of cause a local file path does not work on someone else's computer because he will probably not have the same
				soundbank in the same directory inside of his file system. Therefore you can reference the file by URL.
			</p>
			<p>
				But URLs contain a double slash <code>//</code>, that is also the comment symbol in MidicaPL.
				For this reason the two slashes in the URL must be separated by a space.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.soundbank-url }}</div>
		<div class="cell">
			<p>
				Referencing a soundbank by URL like this works on other computers as well.
				However it will still not work in an exported MIDI file because soundbank information cannot be stored in a MIDI sequence.
			</p>
		</div>
		<div class="cell">
			<h3>Bank Descriptions</h3>
		</div>
		<div class="cell">
			<p>
				In chapter 1 you already learned the simplest form of defining <a href="/tutorial-1.html#instruments">instruments</a> for each channel.
				Remember: In the second column of each line we used an <em>instrument ID</em> or a <em>drumkit ID</em> or a
				<em>MIDI program number</em>.
			</p>
			<p>
				Each ID is mapped to a program number internally. And program numbers can only have values from 0 to 127.
				But comprehensive soundbanks can contain much more than 128 different instruments. In this case the instruments
				are selected by a combination of a <em>program number</em> and a <em>bank description</em>.
			</p>
			<p>
				In the second column of an instrument line the bank description can be attached to the ID or program number separated by a
				<code>,</code> symbol. So <code>VIOLIN,5</code> or <code>40,5</code> would select a violin with the bank description "5".
			</p>
			<p>
				A Bank description can consist of an <abbr title="Most Significant Byte">MSB</abbr> (0-127) and an
				<abbr title="Least Significant Byte">LSB</abbr> (0-127), separated by a <code>/</code> symbol.
				E.g. <code>VIOLIN,5/3</code> would use a violin (program number 40) with a bank MSB of 5 and an LSB of 3.
			</p>
			<p>
				For most soundbanks you only need the MSB, like in the first example. In this case the LSB is 0.
				So <code>VIOLIN,5</code> is the same as <code>VIOLIN,5/0</code>.
			</p>
			<p>
				And if MSB and LSB are both zero, you can omit both and only use the ID or program number. That was the case in the examples from
				chapter 1. So the following instrument definitions are all equal:
			</p>
			<ul>
				<li><code>VIOLIN</code></li>
				<li><code>VIOLIN,0</code></li>
				<li><code>VIOLIN,0/0</code></li>
				<li><code>40</code></li>
				<li><code>40,0</code></li>
				<li><code>40,0/0</code></li>
			</ul>
			<p>
				Alternatively a bank description can also be a full bank number. This can be calculated the following way:
			</p>
			<p>
				<em>Bank Number = MSB * 128 + LSB</em>
			</p>
			<p>
				That means that the following instrument definitions are equal:
			</p>
			<ul>
				<li><code>VIOLIN,5/3</code></li>
				<li><code>VIOLIN,643</code> (5 * 128 + 3 = 643)</li>
			</ul>
			<p>
				Some soundbanks support multi-channel drumkits. That is a drumkit that can also be used in channels other than 9.
				Often such drumkits are located on bank 15360 (MSB 120, LSB 0).
				The following example assumes that you use such a soundbank.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.instruments-2 }}</div>
	</section>
	<section class="grid-x grid-padding-x" id="instrument">
		<div class="cell">
			<h2>Instrument Switch</h2>
		</div>
		<div class="cell">
			<p>
				Sometimes you may need to switch the instrument of one or more channels.
				Then you have to reconfigure these channels accordingly. This can be done in a block or a single line.
			</p>
		</div>
		<div class="cell">
			<h3>Instruments Block</h3>
		</div>
		<div class="cell">
			<p>
				One way to switch instruments is to use the same kind of <code>INSTRUMENTS</code>
				block that you already know. However this block can only contain channels that you have already initialized inside
				of the very first <code>INSTRUMENTS</code> block of your source code.
			</p>
			<p>
				If your first <code>INSTRUMENTS</code> block was the one from the <em>Bank Descriptions</em> section above, you can later
				define a second <code>INSTRUMENTS</code> block that redefines all channels except 6, 7 and 8.
			</p>
			<p>
				Or you can redefine only channel 0, 5, 9 and 15. Then the channels 1-4 and 10-14 would continue using their already
				defined instruments. This would look like the following example:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.instruments-3 }}</div>
		<div class="cell">
			<h3>Single Instrument Switch</h3>
		</div>
		<div class="cell">
			<p>
				Alternatively you can reconfigure a channel in one single line. Therefore the <code>INSTRUMENT</code> command is used.
				(Pay attention to the singular form.)
			</p>
			<p>
				The <code>INSTRUMENT</code> command is followed by the channel number, the instrument definition and the channel description.
			</p>
			<p>
				The rules for channel number, instrument definition and channel details are the same as the rules
				inside of an <code>INSTRUMENTS</code> block. The only difference is that the channel description is optional.
				If it's ommitted, Midica re-uses the old channel description.
			</p>
			<p>
				The following example switches the instruments of the channels 0 and 1:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.instrument }}</div>
		<div class="cell">
			<p>
				With the first command, we simulate a switch of the viola from <em>arco</em> to <em>pizzicato</em> mode.
				Therefore we need a new MIDI instrument in channel 0 but not necessarily a new channel description.
				So we skip that.
			</p>
			<p>
				In channel 1 we switch to a completely different instrument, using a non-standard bank number.
				The program number is the one of a steel guitar but in the current soundbank it's mapped to a mandolin.
				So we use an appropriate channel description to avoid confusion.
			</p>
			<p>
				Another reason to use the single line instrument switch is that it also works inside of a function or block.
				In the next two chapters you will learn what that is.
			</p>
		</div>
	</section>
	<section class="grid-x grid-padding-x" id="variables">
		<div class="cell">
			<h2>Variables</h2>
		</div>
		<div class="cell">
			<p>
				Like in other languages you can use variables in MidicaPL. Variable names begin with a <code>$</code> symbol.
				The rest of the variable name can consist of letters, numbers or underscores. Variable names are case-sensitive.
			</p>
			<p>
				A variable is defined and initialized with the keyword <code>VAR</code>, followed by the variable name, an optional
				<code>=</code> symbol (and/or whitespaces) and the value.
			</p>
			<p>
				Later it can be used by just writing the variable's name.
				The following examples are equivalent. The first one uses variables, the second one doesn't.
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.variable }}</div>
		<div class="cell">
			<p>
				As you can see, you can assign a new value to an already defined variable. This works exactly like the initial definition.
			</p>
		</div>
		<div class="cell">
			<h3>Limitations of Variables</h3>
		</div>
		<div class="cell">
			<p>
				There are some limitations for the usage of variables.
			</p>
			<ul>
				<li>
					A variable's value cannot contain any whitespaces.
				</li>
				<li>
					Variables are officially supported to be used in the following locations:
					<ul>
						<li>As a channel number in a channel command, or a part of it</li>
						<li>As a note, rest, chord or percussion ID in a channel command, or a part of it</li>
						<li>As a length description in a channel command, or a part of it</li>
						<li>As an option value (or a part of it) in any command that supports options</li>
					</ul>
				</li>
			</ul>
			<p>
				In all other locations you should not use variables. They may work or not. But even if they work, they might not
				work in a later Midica version any more.
			</p>
		</div>
	</section>
	<section class="grid-x grid-padding-x" id="barlines">
		<div class="cell">
			<h2>Bar Lines</h2>
		</div>
		<div class="cell">
			<p>
				In compact syntax you can simulate a bar line using the pipe symbol: <code>|</code>.
			</p>
			<p>
				Using bar lines is optional. But if they are used, they must be in the correct place. Whenever you use a bar line,
				Midica will check if the channel's current position is at the border of a measure. Otherwise it will show an error message.
			</p>
			<p>
				The check works like this:
			</p>
			<ul>
				<li>
					It searches the last global command with a <em>time signature</em> and calculates how long each following measure must be.
					If no such command has ever been used, it pretends that a time signature of <em>4/4</em> has been set at the very beginning of the sequence.
					(Like with the command <code>* time 4/4</code>)
				</li>
				<li>
					It measures the length from the position of the last <em>time signature</em> (or the very beginning, if none is found) until the current position.
				</li>
				<li>
					It checks if the result can be divided by a measure length.
				</li>
			</ul>
			<p>
				This is a convenient way to check if everything is correct. The following example shows Happy Birthday with time signatures and bar lines:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.happy-birthday-barlines }}</div>
		<div class="cell">
			<p>
				This time we used the time signature twice: once for the upbeat and then again when the regular measure starts.
				If we would omit the first two bar lines, then we could also omit the time signature for the upbeat in line 1.
				But it's still important to set the <code>3/4</code> time signature directly after the upbeat - and not at the beginning.
				Otherwise the bar lines in the last line would fail.
			</p>
		</div>
		<div class="cell">
			<h3>Bar Line Tolerances</h3>
		</div>
		<div class="cell">
			<p>
				Most of the time you will not need anything more to know about bar lines. But there are special cases, mostly when you
				use complicated tuplets. Then a note length may be not really exact, due to rounding errors. And this results in bar lines
				that are set correctly but fail anyway. The following example shows a score with a nested triplet and the intended result:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.barlines-nested-triplets }}</div>
		<div class="cell">
			<p>
				However the second bar line (marked in red) fails with an error message. Why?
			</p>
			<p>
				A MIDI timeline consists of very small atomic units called <em>ticks</em>. Midica uses a resolution of 480 ticks per quarter note.
				A quarter note in a nested triplet would have <span class="nobr">480 * 2/3 * 2/3</span> ticks. That's <span class="nobr">213 + 1/3</span>.
				But broken ticks are not possible. So this is rounded to 213.
				The three nested quarter notes together have a length of <span class="nobr">213 * 3 = 639</span> instead of their theoretically correct value of 640.
			</p>
			<p>
				To circumvent this problem you can set a tolerance value for a barline. This is a number that you just attach to the barline directly, without any
				whitespace. To set a tolerance of 3 ticks, you would use: <code>|3</code>.
			</p>
			<p>
				For our example, a tolerance of 1 tick is sufficient, as the following, now working example shows:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.barlines-nested-triplets-2 }}</div>
		<div class="cell">
			<p>
				The first bar line has the default tolerance, which is 0. In the second bar line (marked in blue) we set the tolerance to 1.
			</p>
			<p>
				The third bar line succeeds as well - even if we would probably expect it to fail.
			</p>
			<p>
				The reason is that <code>|1</code> sets the tolerance not only for the second bar line but also for <em>all</em> following bar lines in the same channel.
			</p>
			<p>
				That's a very convenient way to reduce the need to set tolerances. Mostly we can just write <code>|</code>.
			</p>
		</div>
		<div class="cell">
			<h3>Global Change of Bar Line Tolerances</h3>
		</div>
		<div class="cell">
			<p>
				If we use several channels, we want to synchronize them with <code>*</code> from time to time.
				In this case we may need to apply a tolerance to <em>all</em> channels.
			</p>
			<p>
				The following example shows a score with a septuplet and the intended result.
				The second bar line in channel 0 needs a tolerance of 2, marked in blue.
				In line 3, we syncronize (<code>*</code>) the channels to avoid the need to write an explicit rest in channel 1.
				However in channel 1 the barline marked in red fails:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.barlines-74 }}</div>
		<div class="cell">
			<p>
				The reason is that after the sync <code>*</code> in line 3, the bar lines in channel 1 also need a tolerance.
				One possible solution is to change the bar line marked in red from <code>|</code> to <code>|2</code>.
				But that's unconvenient and ugly, especially if we have more channels than 2.
			</p>
			<p>
				A better solution is to modify the sync command to set a tolerance globally.
				Therefore we add two columns to the sync command, each one separated by whitespace(s).
				The first one ist the bar line symbol <code>|</code>, the second one is the new global tolerance value.
			</p>
			<p>
				In this case, we want to set a tolerance of 2 for all channels, so we write <code>* | 2</code>, as the following example demonstrates:
			</p>
		</div>
		<div class="cell">{{> src-example src-examples.barlines-74-2 }}</div>
		<div class="cell">
			<p>
				This time we don't get an error message any more.
			</p>
		</div>
	</section>
	<aside>
		Now you know the most important compact and lowlevel commands of MidicaPL. The next chapters will focus on highlevel structures.
		Please continue with <a href="tutorial-3.html">chapter 3</a> in order to learn about functions.
	</aside>
</div>
